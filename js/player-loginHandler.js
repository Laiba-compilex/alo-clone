"undefined"==typeof LoginHandler&&(LoginHandler={}),function(){function e(){try{$j("#account_li").removeClass("error"),$j("#password_li").removeClass("error");const s=$j("#webSite").val(),r=$j("#sessionKey").val(),a=PageConfig.isNewLoginPage?$j(".lang").find("li.selected").attr("value"):$j("#lang option:selected").val();let t,i,l,c=null;if(PageConfig.enableSmsOtp&&$j("#SMSlogin").hasClass("active")){if(t=$j("#SMSaccount").val(),l=$j("#SMSrememberMe").prop("checked"),c=$j("#otp").val(),null==t||0==t.length)return void n(I18N.get("msg.error.account.accountEmpty"));if(null==c||0==c.length)return void n(I18N.get("player.register.otpNoticeInfo"));if(!/^[0-9]{6}$/.test(c))return void n(I18N.get("player.register.otpFormatInfo"));t=t.toLowerCase(),$j("#SMSaccount").val(t)}else{if(t=$j("#account").val(),i=$j("#password").val(),l=$j("#rememberMe").prop("checked"),null==t||0==t.length)return void n(I18N.get("msg.error.account.accountEmpty"));if(null==i||0==i.length)return void n(I18N.get("msg.error.account.passwordEmpty"));i=EncryptUtil.mask(EncryptUtil.mask(i)+r),t=t.toLowerCase(),$j("#account").val(t)}PopupUtil.openModal("#loadingMask"),DeviceId.getPromise().then(r=>{postAjax({url:PageConfig.playerLogin,data:{loginName:t,webSite:s,password:i,lang:a,timeZone:(new Date).getTimezoneOffset(),rememberMe:l,deviceId:r,otp:c,otpKey:PageConfig.otpKey,isPWA:isPWA(),isShowDownloadApp:PageConfig.isShowDownloadApp},success:function(e){if("200"!=e.status){if(BridgeUtils.sendMessage(JSON.stringify({status:e.status})),e.sessionKey&&$j("#sessionKey").val(e.sessionKey),e.error)n(e.error);else if(e.message){if(e.message.indexOf("msg.error.account.loginTimesOverPassword")>-1)return n("ERROR OVER 8 TIMES"),$j("#password").focus(),$j("#password_li").addClass("error"),void PopupUtil.closeModal("#loadingMask");if(e.message.indexOf("msg.error.account.isLocked")>-1)return n("Account is locked!"),void PopupUtil.closeModal("#loadingMask");e.message.indexOf("msg.error.account.notExist")>-1||e.message.indexOf("msg.error.account.loginFailPassword")>-1?n(I18N.get("msg.error.account.invalidUserIdOrPassword")):n(I18N.get(e.message)),e.message.indexOf("msg.error.account.notExist")>-1||e.message.indexOf("msg.error.account.notActive")>-1?($j("#account").focus(),$j("#account_li").addClass("error")):e.message.indexOf("msg.error.account.loginFailPassword")>-1&&($j("#password").focus(),$j("#password_li").addClass("error"))}return o(),void PopupUtil.closeModal("#loadingMask")}e.targetPath&&(BridgeUtils.sendMessage(JSON.stringify({userID:e.userID,webSite:e.webSite,sessionId:e.sessionId,needPushy:e.needPushy,rememberMe:1==l?t:"",page:"gameHall",isShowHomeButton:"true",loginName:e.loginName,allowQuickLogin:e.allowQuickLogin})),window.location.replace(e.targetPath))},beforeSend:function(){PopupUtil.openModal("#loadingMask")},resetSessionKey:function(o){$j("#sessionKey").val(o),e()}})})}catch(e){return n(e.message),!1}return!1}function o(){$j("#password").val(""),PageConfig.enableSmsOtp&&$j("#otp").val(""),JCache.get("#account").val()?JCache.get("#password").focus():JCache.get("#account").focus()}function n(e){var o=JCache.get("#errorMsg");o?(o.html(e),/opacity/.test(o.attr("style"))&&o.css({opacity:"1"}),o.show(),o.parent().show()):alert(e)}function s(e){PageConfig.otpKey=e,PageConfig.beatsCount=PageConfig.otpWaitingTime,$j("#smsBtn").addClass("disabled"),$j("#smsBtn").text(PageConfig.beatsCount),PageConfig.timer=setInterval(function(){PageConfig.beatsCount=PageConfig.beatsCount-1,PageConfig.beatsCount<=0?(clearInterval(PageConfig.timer),$j("#smsBtn").text(I18N.get("text.inbox.resend")),$j("#smsBtn").removeClass("disabled")):$j("#smsBtn").text(PageConfig.beatsCount)},1e3)}function r(){const e=$j("#modal-previousPage").find(".item input[type=checkbox]");e.length===e.filter(":checked").length?$j("#previousPageCloseBtn").removeClass("disabled"):$j("#previousPageCloseBtn").addClass("disabled")}LoginHandler.init=function(){$j("#account").blur(function(){var e=$j(this).val();e=e.toLowerCase(),$j(this).val(e)}),$j("input").keydown(function(e){return!!$j("#loadingMask").is(":visible")||(!KeyEventUtils.keyCode(e).isEnter||(LoginHandler.playerLoginCheck(),!1))}),localStorage.removeItem("playing-one-balance"),o(),JCache.get("#toggleBtn").click(function(){$j(this).toggleClass("icon-eye-open icon-eye-close");var e=$j("#password");"password"==e.attr("type")?e.attr("type","text"):e.attr("type","password"),e.focus()});let e=CookieUtil.getCookie("demoAccount"),n=CookieUtil.getCookie("demoPass");isPWA()&&""!=e&&""!=n?($j("#account").val(e),$j("#password").val(n),$j("#rememberMe").removeAttr("checked")):PageConfig.userIdinCookie&&0!=PageConfig.userIdinCookie.length?($j("#account").val(PageConfig.userIdinCookie),$j("#rememberMe").attr("checked",!0),PageConfig.enableSmsOtp&&($j("#SMSaccount").val(PageConfig.userIdinCookie),$j("#SMSrememberMe").attr("checked",!0))):($j("#account").val(""),$j("#rememberMe").removeAttr("checked"),PageConfig.enableSmsOtp&&($j("#SMSaccount").val(""),$j("#SMSrememberMe").removeAttr("checked")));const s=$j("#modal-previousPage"),a=s.find("#selectAll"),t=s.find(".item input[type=checkbox]");a.on("change",function(){const e=this.checked;t.prop("checked",e).trigger("change"),r()}),t.on("change",function(){const e=t.length===t.filter(":checked").length;a.prop("checked",e),r()}),r()},LoginHandler.buildQrcode=function(e){for(let o=0;o<e;o++){let e="#qrcode"+o,n="#contact-menu"+o;$j(e).qrcode({text:$j(e).attr("value"),render:"image",size:"100",quiet:2,id:"qrcode-image"+o}),$j(n).attr("title",$j(n).attr("title")+$j(e).find("#qrcode-image"+o).prop("outerHTML"))}},LoginHandler.updatePasswordAndLoginName=function(){try{if(displaySuccessMessage("checkLoginNameMsg"),displaySuccessMessage("checkOldPwdMsg"),displaySuccessMessage("checkNewPwdMsg"),displaySuccessMessage("checkConfirmPwdMsg"),PageConfig.isPasswordExpired){if(!checkInput("oldPassword")||!checkLength("oldPassword",8,15))return void displayErrorMessage("checkOldPwdMsg",I18N.get("msg.error.oldPassword"));if(!checkInput("newPassword")||!checkLength("newPassword",8,15))return void displayErrorMessage("checkNewPwdMsg",I18N.get("msg.error.newPassword"));if(!checkInput("newPasswordConfirm")||!checkLength("newPasswordConfirm",8,15))return void displayErrorMessage("checkConfirmPwdMsg",I18N.get("msg.error.confirmPassword"));if($j("#newPassword").val()!==$j("#newPasswordConfirm").val())return void displayErrorMessage("checkConfirmPwdMsg",I18N.get("msg.error.passwordDiff"));if(!ValidateUtil.isValidPassword($j("#newPassword").val()))return void displayErrorMessage("checkNewPwdMsg",I18N.get("msg.error.newPasswordNotVaild"));if(!ValidateUtil.isValidPassword($j("#newPasswordConfirm").val()))return void displayErrorMessage("checkConfirmPwdMsg",I18N.get("msg.error.confirmPasswordNotVaild"))}let e;if(PageConfig.needUpdateName){if(!LoginHandler.checkName())return;e=JCache.get("#name").val()}const o=JCache.get("#loginName").val();let n=null;if(PageConfig.canEditTelColumn&&(n=LoginHandler.iti.getNumber(),""!=n)){if(!LoginHandler.checkPhoneNumber())return;if(!LoginHandler.checkOtpCode(!0))return}if(PageConfig.isForceUpdateLoginName){if(o.startsWith("onesub"))return void displayErrorMessage("checkLoginNameMsg",I18N.get("agent.myProfile.msg.nicknameCantUse"));if(!isValidLoginName(o))return void displayErrorMessage("checkLoginNameMsg",I18N.get("agent.myProfile.msg.nicknameFormatError"));postAjax({url:PageConfig.checkLoginNameUrl,type:"POST",data:{loginName:o},success:function(s){if(s){displaySuccessMessage("checkLoginNameMsg",I18N.get("agent.myProfile.msg.nicknameCanUse"));var r=[];r.push(o),confirm(I18N.get("msg.confirmUpdateLoginName",r))&&postAjax({url:PageConfig.updatePasswordAndLoginName,data:{oldPassword:PageConfig.isPasswordExpired&&$j("#oldPassword").length?EncryptUtil.mask($j("#oldPassword").val()):null,newPassword:PageConfig.isPasswordExpired?EncryptUtil.mask($j("#newPassword").val()):null,loginName:PageConfig.isForceUpdateLoginName?o:null,phoneNumber:n,otpKey:PageConfig.isOTPCheckNeeded?PageConfig.otpKey:null,otp:PageConfig.isOTPCheckNeeded?$j("#otp").val():null,name:e},success:function(e){"200"==e.status?(alert("update success."),window.location.replace(e.targetPath),BridgeUtils.sendMessage(JSON.stringify({loginName:o,allowQuickLogin:"1"}))):alert(e.error)}})}else displayErrorMessage("checkLoginNameMsg",I18N.get("agent.myProfile.msg.nicknameCantUse"))}})}else postAjax({url:PageConfig.updatePasswordAndLoginName,data:{oldPassword:PageConfig.isPasswordExpired&&$j("#oldPassword").length?EncryptUtil.mask($j("#oldPassword").val()):null,newPassword:PageConfig.isPasswordExpired?EncryptUtil.mask($j("#newPassword").val()):null,loginName:PageConfig.isForceUpdateLoginName?o:null,phoneNumber:n,otpKey:PageConfig.isOTPCheckNeeded?PageConfig.otpKey:null,otp:PageConfig.isOTPCheckNeeded?$j("#otp").val():null,name:e},success:function(e){"200"==e.status?(alert("update success."),window.location.replace(e.targetPath),BridgeUtils.sendMessage(JSON.stringify({loginName:o,allowQuickLogin:"1"}))):alert(e.error)}})}catch(e){return alert(e.message),!1}return!1},LoginHandler.testLogin=e,LoginHandler.playerLoginCheck=once(e,3e3),LoginHandler.bindContactEvents=function(){$j("#contactLi").click(function(){$j("#contactDiv").show()}),$j("#closeContact").click(function(){$j("#contactDiv").hide()})},LoginHandler.checkLoginName=function(){var e=JCache.get("#loginName").val().toLowerCase();e.startsWith("onesub")?displayErrorMessage("checkLoginNameMsg",I18N.get("agent.myProfile.msg.nicknameCantUse")):isValidLoginName(e)?postAjax({url:PageConfig.checkLoginNameUrl,type:"POST",data:{loginName:e},success:function(e){e.error?displayErrorMessage("checkLoginNameMsg",e.error):e?displaySuccessMessage("checkLoginNameMsg",I18N.get("agent.myProfile.msg.nicknameCanUse")):displayErrorMessage("checkLoginNameMsg",I18N.get("agent.myProfile.msg.nicknameCantUse"))}}):displayErrorMessage("checkLoginNameMsg",I18N.get("agent.myProfile.msg.nicknameFormatError"))},LoginHandler.closeMask=function(){PopupUtil.closeModal("#hyperLinkArea"),$j("#popupMask").removeClass("modal-backdrop show"),$j("body").removeClass("modal-open")},LoginHandler.intlTel=function(){if(!PageConfig.canEditTelColumn)return!1;const e={separateDialCode:!0,utilsScript:PageConfig.intlTelInputUtilsUrl};try{if(PageConfig.phoneCountries)e.onlyCountries=PageConfig.phoneCountries.split(","),e.allowDropdown=!1;else{if(PageConfig.isOTPCheckNeeded)throw"phone countries setting error!";e.initialCountry="auto",e.geoIpLookup=function(e){e(PageConfig.country)}}let o=document.querySelector("#phoneNumber");LoginHandler.iti=window.intlTelInput(o,e)}catch(e){console.error(e),$j("#phoneNumberError").html(`<p class="msg"><i class="icon-alert-circle"></i>${e}</p>`).show()}},LoginHandler.checkPhoneNumber=function(){try{if(!PageConfig.canEditTelColumn)return!0;let e=LoginHandler.iti,o=e.getNumber(),n=e.getSelectedCountryData().iso2,s=libphonenumber.PhoneNumberUtil.getInstance(),r=s.isValidNumberForRegion(s.parse(o,n),n);return PageConfig.isOTPCheckNeeded&&o!==PageConfig.phoneNumberSnapshot&&(PageConfig.otpKey=void 0),PageConfig.phoneNumberSnapshot=o,r?($j("#phoneNumberError").hide(),!0):($j("#phoneNumberError").html(`<p class="msg"><i class="icon-alert-circle"></i>${I18N.get("player.register.phoneNumberNoticeInfo")}</p>`).show(),!1)}catch(e){return $j("#phoneNumberError").html(`<p class="msg"><i class="icon-alert-circle"></i>${I18N.get("player.register.phoneNumberNoticeInfo")}</p>`).show(),!1}},LoginHandler.checkName=function(){const e=$j("#name");return 0===e.val().length?(e.parent().addClass("is-error"),$j("#nameError").html(`<p class="msg"><i class="icon-alert-circle"></i>${I18N.get("player.verify.identity.realName.captionEmpty")}</p>`).show(),!1):StringUtil.isContainsEmoji(e.val())?(e.parent().addClass("is-error"),$j("#nameError").html(`<p class="msg"><i class="icon-alert-circle"></i>${I18N.get("msg.error.invalidName")}</p>`).show(),!1):(e.parent().removeClass("is-error"),$j("#nameError").hide(),!0)},LoginHandler.getSmsOtpCode=function(){if(PageConfig.sending||!LoginHandler.checkPhoneNumber())return;const e=LoginHandler.iti,o=e.getNumber();postAjax({url:PageConfig.smsOtpUrl,type:"POST",data:{telCountry:e.getSelectedCountryData().iso2,tel:o},success:function(e){e.otpKey?(s(e.otpKey),$j("#smsInfo").text(I18N.get("player.register.otpMessage",Array(o))).show(),$j("#otpError").hide()):e.error&&$j("#otpError").html(`<p class="msg"><i class="icon-alert-circle"></i>${e.error}</p>`).show()},beforeSend:function(){PageConfig.sending=!0},complete:function(){PageConfig.sending=!1},resetSessionKey:function(e){$j("#sessionKey").val(e),PageConfig.sending=!1,LoginHandler.getSmsOtpCode()}})},LoginHandler.checkOtpCode=function(e){if(PageConfig.isOTPCheckNeeded){const o=$j("#otp").val();if(e&&null==PageConfig.otpKey)return $j("#otpError").html(`<p class="msg"><i class="icon-alert-circle"></i>${I18N.get("player.register.otpNoticeInfo")}</p>`).show(),!1;if(null==o||!/^[0-9]{6}$/.test(o))return $j("#otpError").html(`<p class="msg"><i class="icon-alert-circle"></i>${I18N.get("player.register.otpFormatInfo")}</p>`).show(),!1;$j("#otpError").hide()}return!0},LoginHandler.getLoginPageSmsOtpCode=function(){if($j("#errorMsg").parent().hide(),PageConfig.sending)return;let e=$j("#SMSaccount").val();null!=e&&0!=e.length?(e=e.toLowerCase(),$j("#SMSaccount").val(e),postAjax({url:PageConfig.smsOtpUrl,type:"POST",data:{loginName:e,sessionKey:$j("#sessionKey").val()},success:function(e){e.otpKey?(s(e.otpKey),$j("#smsInfo").text(I18N.get("player.register.otpMessage",Array(e.tel))).show()):e.error&&n(e.error)},beforeSend:function(){PageConfig.sending=!0},complete:function(){PageConfig.sending=!1},resetSessionKey:function(e){$j("#sessionKey").val(e),PageConfig.sending=!1,LoginHandler.getLoginPageSmsOtpCode()}})):n(I18N.get("msg.error.account.accountEmpty"))},LoginHandler.getCricketDomain=function(){return new Promise((e,o)=>{postAjax({url:PageConfig.getCricketDomainUrl,type:"POST",success:function(n){null!=n.error?o(n.error):e(n.cricketDomain)}})})}}();const isValidLoginName=function(e){return/^[0-9a-zA-Z]{4,20}$/.test(e)},displaySuccessMessage=function(e,o){const n=$j("#"+e);n.parent().removeClass("is-error"),o?(n.removeClass("error"),n.addClass("success"),n.html(`<p class="msg"><i class="icon-checked-circle"></i>${o}</p>`).show()):n.hide()},displayErrorMessage=function(e,o){const n=$j("#"+e);n.parent().addClass("is-error"),n.removeClass("success"),n.addClass("error"),n.html(`<p class="msg"><i class="icon-alert-circle"></i>${o}</p>`).show()},checkInput=function(e){const o=$j("#"+e);return!o.length||void 0!==o.val()&&0!==o.val().length},checkLength=function(e,o,n){const s=$j("#"+e);return!s.length||!(s.val().length<o)&&!(n&&s.val().length>n)};