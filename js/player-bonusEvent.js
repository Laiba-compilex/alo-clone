"undefined"==typeof BonusEventHandler&&(BonusEventHandler={}),function(){let e,t,n,a;BonusEventHandler.gameTagIdMap={},BonusEventHandler.challengeIncludeGame={},BonusEventHandler.challengingTicketMap={},BonusEventHandler.banners=[],BonusEventHandler.stickers=[];let s=[];function i(e){const[t,n]=e.split(" "),[a,s,i]=t.split("-").map(Number),[o]=n.split(":").map(Number),l=(new Date).getTimezoneOffset();let r=parseFloat(MathUtil.decimal.divide(l,60)),d=new Date(Date.UTC(a,s-1,i,o));return d.addHours(-8-r),d}function o(e){let t=e.split("T"),n=t[0].split("-"),a=t[1].split(":");return`${n[1]}/${n[2]} ${a[0]}:${a[1]} ${parseInt(a[0]<12)?"AM":"PM"}`}function l(s){let l,r=new Array,d=0,c=[];if(s.forEach(function(s){if("DAILY_MISSION"==s.presentType)return void c.push(s);let o,m=document.createElement("div");m.className="page-backdrop",m.setAttribute("onclick","BonusEventHandler.toggleBonusEvent(this);"),m.setAttribute("bonusid",s.bonusId),document.body.appendChild(m);let u=BonusEventPresentHandler.getHandler(s.presentType);if(["SIGNUP","DAILY_MISSION","JACKPOT"].includes(s.presentType)||!GameHallUtils.isRWD()&&!GameHallUtils.isEZ()||!(d>=2)){if("REBATE"==s.presentType){PageConfig.rebateBonusEntityArr.push(s);let l=JSON.parse(s.prizeDistribution);l.rebateRatio=MathUtil.decimal.multiply(l.rebateRatio,100),s.prizeJson=l,BonusEventHandler.buildEntrance(s,PageConfig.gameHallType,PageConfig.isMobile),o=e.safeSelector("#rebatePageTemplate").cloneNode(!0);let r=o.safeSelector("#platformImg");if(r.setAttribute("src",`${PageConfig.imagePrefix}/theme/images/src-common/PLATFORM-img/120x80-fullname/${s.platform}-logo.webp`),r.classList.add(s.platform),$j("#rebateRatio").html(s.prizeJson.rebateRatio),t){let e=i(s.startDate),o=i(s.endDate),l=s.endDate;e.getTime()<t.getTime()&&(t=e),o.getTime()>n.getTime()&&(n=o,a=l)}else t=i(s.startDate),n=i(s.endDate),a=s.endDate}else if("GOLDEN_EGG"==s.presentType){let t=document.createElement("div");t.className="goldenEgg-backdrop",t.setAttribute("bonusid",s.bonusId),document.body.appendChild(t),BonusEventHandler.buildEntrance(s,PageConfig.gameHallType,PageConfig.isMobile),o=e.safeSelector("#goldenEggPage").cloneNode(!0),o.safeSelector("#bonusHeaderImg").setAttribute("src",`${PageConfig.imagePrefix}/theme/images/src-common/PLATFORM-img/100x100/${s.platform}-logo.webp`),d+=1;let n=s.skinName,a=`GOLDENEGG/${n.toUpperCase()}`;o.safeSelector("#ticketIcon").setAttribute("src",`${PageConfig.imagePrefix}/theme/images/src-common/BONUSEVENT-img/${a}/gold${n}-ticket.webp`)}else"SIGNUP"===s.presentType?o=e.safeSelector("#bonusSignupEventPage").cloneNode(!0):"JACKPOT"===s.presentType||(BonusEventHandler.buildEntrance(s,PageConfig.gameHallType,PageConfig.isMobile),o=e.safeSelector("#bonusEventPage").cloneNode(!0),o.safeSelector("#bonusHeaderImg").setAttribute("src",`${PageConfig.imagePrefix}/theme/images/src-common/PLATFORM-img/100x100/${s.platform}-logo.webp`),d+=1);if("REBATE"==s.presentType){o.setAttribute("id","PageDiv"+s.bonusId),o.safeSelector("#currency").classList.add(PageConfig.playerCurrency),o.safeSelector("#infoHtml").innerHTML=s.infoHtml,o.safeSelector("#hintHtml").innerHTML=s.hintHtml,o.setAttribute("presentType",s.presentType),o.dataset.platform=s.platform,s.activeHoursPeriodList.length>0&&(o.safeSelector("#activeHoursPeriodDiv").style.display=""),function(e,t,n){let a=new Date,s=(new Date).setDate(a.getDate()+1),i=(new Date).getTimezoneOffset(),o=parseFloat(MathUtil.decimal.divide(i,60)),l=DateUtil.getLocalDate(n+":00:00"),r=`<ul class="num-${t.length}">`,d=!1;if(t.length>0){for(let e=0;e<t.length;e++){let n,i=t[e],c=i.startHour,m=i.endHour,u=new Date(a);u.setHours(c,0,0),u.addHours(-8-o),c>m?(n=new Date(s),n.setHours(m,0,0)):(n=new Date(a),n.setHours(m,0,0)),n.addHours(-8-o);let p="";a>=u&&a<n&&a>=l&&(p="on",d=!0);let g=u.getHours(),f=n.getHours(),b=u.getMinutes(),v=n.getMinutes(),y=f+""+(v<10?"0"+v:v);r+=`<li period-start="${parseInt(g+""+(b<10?"0"+b:b))}" period-end="${parseInt(y)}" class="${p}"><span>${g}</span>:<span>${0==b?"0"+b:b}</span>-<span>${f}</span>:<span>${0==v?"0"+b:b}</span></li>`}r+="</ul>",e.safeSelector("#activeHoursPeriodDiv").innerHTML=r}else d=a>=l;d||(e.classList.add("coming-soon"),e.safeSelector("#comingSoonTxt").style.display="")}(o,s.activeHoursPeriodList,s.startDate),u.buildResultArea(s,e,o.safeSelector("#bonusEventResultWrapper"));let t=o.safeSelector("#rebateGameWrapper");s.requiredGameList.forEach(function(n){let a=n.platform;if(!s.isEnd){let e=BonusEventHandler.gameTagIdMap[GameHallUtils.buildCacheKey(n)];e||(e={},BonusEventHandler.gameTagIdMap[GameHallUtils.buildCacheKey(n)]=e),e[u.gameTagId]=1}let i,o=e.safeSelector("#bonusEventRebateGameTemplate").cloneNode(!0);PageConfig.showEntryGameType.includes(n.gameType.toUpperCase())?(i=GameHallUtils.getEntryGameEventImgUrl(n),GameHallUtils.setBonusEventClass(t,n)):i=GameHallUtils.getImgUrl(n,!0),o.safeSelector("#gameImg").setAttribute("src",i),o.setAttribute("platform",a),o.setAttribute("id",a+"_"+n.gameKey),o.safeSelector("#gameName").innerHTML=GameHallUtils.getGameDisplayName(n),o.classList.add(a),GameHallUtils.setGameInfoToBtn(o,n),GameHallUtils.displayByBonusLimit(o),t.appendChild(o)}),document.getElementById("rebateSection").appendChild(o),o.safeSelector("#platform").value=s.platform,r.push(s.bonusId),PageConfig.showPromoGameTypeByPlatform&&PageConfig.canShowGameTypeList.forEach(e=>{s.allGamePlatforms.forEach(t=>{if(PageConfig.showPromoGameTypeByPlatform.has(e)){PageConfig.showPromoGameTypeByPlatform.get(e).add(t)}else PageConfig.showPromoGameTypeByPlatform.set(e,new Set([t]))})})}else if("JACKPOT"!=s.presentType){o.setAttribute("id","PageDiv"+s.bonusId),o.setAttribute("style",'background-image: url("//'+s.backgroundUrl+'")'),o.setAttribute("bonusId",s.bonusId),o.setAttribute("issueType",s.issueType),o.setAttribute("platform",s.platform),o.setAttribute("freeSpinGameLines",s.freeSpinGameLines),o.setAttribute("isOnlyApp",s.isOnlyApp),o.setAttribute("skinName",s.skinName),o.classList.add(s.platform),u.className.split(" ").forEach(function(e){o.classList.add(e)}),PageConfig.isMobile||o.classList.add("iframe-div"),o.safeSelector("#backBtn").setAttribute("bonusId",s.bonusId),o.safeSelector("#bonusDetailBtn").setAttribute("bonusId",s.bonusId),"GOLDEN_EGG"===s.presentType&&o.classList.add(`gold${s.skinName}`),o.safeSelector("#bonusEventTime").innerHTML=s.eventTimeDesc,o.safeSelector("#totalBonus").innerHTML=NumberFormatUtil.formatNumber(s.grandPrize,0),o.safeSelector("#currency").classList.add(PageConfig.playerCurrency),o.safeSelector("#bonusTurnoverDes").innerHTML=s.infoHtml,o.safeSelector("#hintHtml").innerHTML=s.hintHtml,o.safeSelector("#footerHtml").innerHTML=s.footerHtml,o.safeSelector("#barrageSwiper").setAttribute("id","barrageSwiper"+s.bonusId),o.setAttribute("presentType",s.presentType),o.setAttribute("presentPrizeNum",s.presentPrizeNum),u.buildResultArea(s,e,o.safeSelector("#bonusEventResultWrapper")),"{}"==s.miniGamePrizeDistribution+""?(o.classList.add("no-chance"),o.dataset.minigame=!1):o.dataset.minigame=!0,o.querySelectorAll(".bonus-img").forEach(function(e){e.setAttribute("bonusId",s.bonusId)});let t=o.safeSelector("#bonusEventGameWrapper");if(t.classList.add("num-"+s.requiredGameList.length),s.requiredGameList.forEach(function(n){let a=n.platform;if(!s.isEnd){let e=BonusEventHandler.gameTagIdMap[GameHallUtils.buildCacheKey(n)];e||(e={},BonusEventHandler.gameTagIdMap[GameHallUtils.buildCacheKey(n)]=e),s.skinName?e[u.gameTagId[s.skinName]]=1:e[u.gameTagId]=1}let i,o=e.safeSelector("#bonusEventGameTemplate").cloneNode(!0);PageConfig.showEntryGameType.includes(n.gameType.toUpperCase())?(i=GameHallUtils.getEntryGameEventImgUrl(n),GameHallUtils.setBonusEventClass(t,n)):i=GameHallUtils.getImgUrl(n,!0),o.safeSelector("#gameImg").setAttribute("src",i),o.setAttribute("platform",a),o.setAttribute("id",a+"_"+n.gameKey),GameHallUtils.setGameInfoToBtn(o,n),GameHallUtils.displayByBonusLimit(o),t.appendChild(o)}),s.isAllowMultiplyBonus){let t=o.safeSelector("#challengeGameWrapper");s.challengeGameList.forEach(function(n){let a=n.platform,s=e.safeSelector("#bonusEventGameTemplate").cloneNode(!0);s.safeSelector("#gameImg").setAttribute("src",GameHallUtils.getImgUrl(n,!0)),s.setAttribute("platform",a),s.setAttribute("id",a+"_"+n.gameKey),GameHallUtils.isWL()?$j(s).find(".show-jackpot").hide():n.showJackpot?$j(s).find(".show-jackpot").show():$j(s).find(".show-jackpot").hide(),GameHallUtils.setGameInfoToBtn(s,n),GameHallUtils.displayByBonusLimit(s),t.appendChild(s)})}if(s.isAllowRankReward){let e=JSON.parse(s.rankRewardSetting);for(let t in e){let n=o.safeSelector("#rankReward").safeSelector("#"+t+"Reward");n.setAttribute("bonusId",s.bonusId),n.setAttribute("rankRewardSetting",e[t])}if(s.rankRecordMedal&&(0==s.rankRecordMedal.dailyMedalCount&&0==s.rankRecordMedal.weeklyMedalCount&&0==s.rankRecordMedal.monthlyMedalCount||(o.safeSelector("#bonusGroup").style.display="",o.safeSelector("#rankReward").style.display="",o.classList.remove("no-tournament"),0==s.rankRecordMedal.dailyMedalCount&&o.safeSelector("#dailyCheckIn").classList.add("no-ticket"),0==s.rankRecordMedal.weeklyMedalCount&&o.safeSelector("#weeklyReward").classList.add("no-ticket"),0==s.rankRecordMedal.monthlyMedalCount&&o.safeSelector("#monthlyReward").classList.add("no-ticket"),o.safeSelector("#dailyRewardCnt").innerText=s.rankRecordMedal.dailyMedalCount,o.safeSelector("#weeklyRewardCnt").innerText=s.rankRecordMedal.weeklyMedalCount,o.safeSelector("#monthlyRewardCnt").innerText=s.rankRecordMedal.monthlyMedalCount)),"GOLDEN_EGG"==s.presentType){let e=`<div class="txt-balance ${PageConfig.playerCurrency}" id="goldenEggWinBonus" style="display:none"></div>\n\t\t\t\t\t\t\t\t\t<div class="slot-box" id="winAreaRankRewardSlot" style="display:none">\n\t\t\t\t\t\t\t\t\t\t<div id="stage" class="tournament-slot">\n\t\t\t\t\t\t\t\t\t\t\t<div id="rotate" class="slotNum">\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="ring1" class="ring"></div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<img class="slot-object" alt="" src="${PageConfig.imagePrefix}/theme/images/src-common/BONUSEVENT-img/GOLDENEGG/tournament-slot.webp"/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>`,t="egg"==s.skinName?"eggWinAreaWrapper":"boxWinArea",n=document.getElementById(t);n&&!n.querySelector("#winAreaRankRewardSlot")&&n.insertAdjacentHTML("afterbegin",e)}}document.getElementById("gameHallDiv");document.body.appendChild(o),o.safeSelector("#platform").value=s.platform,s.isAllowMultiplyBonus&&(o.safeSelector("#bonusMultiplier").value=s.bonusMultiplier,o.safeSelector("#turnoverMultiplier").value=s.turnoverMultiplier,o.safeSelector("#multiplyExpireHours").value=s.multiplyExpireHours,o.safeSelector("#redeemDeadlineDate").value=s.redeemDeadlineDate,o.safeSelector("#multiplyHtml").value=s.multiplyHtml,BonusEventHandler.challengeIncludeGame[s.bonusId]=s.challengeGameList.map(e=>e.gameCode));let n=PageConfig.gameHallType.startsWith("RWD")?"-RWD":"-s";s.presentType.startsWith("RAFFLE")&&(n="");let a=$j(o).find("#timePageWrapper");if("SIGNUP"!==s.presentType&&"GOLDEN_EGG"!==s.presentType)if("MARIOSLOT"!==s.presentType){let e=s.presentType.split("_")[0];const t=e+"/"+e.toLowerCase();a.append($j('<img src="'+PageConfig.imagePrefix+"/theme/images/src-common/BONUSEVENT-img/"+t+n+'.webp" alt>'))}else a.append($j('<img src="'+PageConfig.imagePrefix+"/theme/images/src-common/BONUSEVENT-img/MARIO/monopoly"+n+'.webp" alt>'));if(s.isEnd)a.append($j("<span>Draw Time</span>"));else{let e=DateUtil.getLocalDate(s.endDate+":00:00");"SIGNUP"!=s.presentType&&"DAILY_MISSION"!=s.presentType&&(void 0===l||e<l)&&(l=e),CountDownUtil.countToTime({countArea:a.find("span"),expireTime:e,expireText:"Draw Time",showHours:!0})}if(parseInt(s.ticketCount)>0&&"AUTO_REDEEM"!=s.presentType&&"DAILY_MISSION"!=s.presentType&&r.push(s.bonusId),PageConfig.showPromoGameTypeByPlatform&&"SIGNUP"!=s.presentType&&PageConfig.canShowGameTypeList.forEach(e=>{s.allGamePlatforms.forEach(t=>{if(PageConfig.showPromoGameTypeByPlatform.has(e)){PageConfig.showPromoGameTypeByPlatform.get(e).add(t)}else PageConfig.showPromoGameTypeByPlatform.set(e,new Set([t]))})}),"GOLDEN_EGG"==s.presentType){var p=o.querySelector("#freeSpinSticker");p&&p.parentNode.removeChild(p)}}}}),c.length>0){c.sort((e,t)=>new Date(t.updateTime)-new Date(e.updateTime));let t,n=c.map(e=>e.bonusId).join(","),a=document.createElement("div");a.className="page-backdrop",a.setAttribute("onclick","BonusEventHandler.toggleBonusEvent(this);"),a.setAttribute("bonusid",n),a.setAttribute("presentType","DAILY_MISSION"),document.body.appendChild(a);let s=BonusEventPresentHandler.getHandler("DAILY_MISSION");t=e.safeSelector("#bonusDailyMissionEventPage").cloneNode(!0),s.processEvent(c,e,t);for(const e of c){let n,a,s=$j(t).find(`#PageDiv${e.bonusId}`).find("#cumulativeBoxWrapper"),i=!1,o=!1;s.on("mousedown",function(e){i=!0,n=e.pageX,a=s.scrollLeft(),e.preventDefault()}),$j(document).on("mouseup",function(e){i=!1,setTimeout(function(){o=!1},300)}),s.on("mousemove",function(e){if(i){e.preventDefault(),o=!0;const t=e.pageX-n;s.scrollLeft(a-t)}}),PageConfig.showPromoGameTypeByPlatform&&PageConfig.canShowGameTypeList.forEach(t=>{e.allGamePlatforms.forEach(e=>{if(PageConfig.showPromoGameTypeByPlatform.has(t)){PageConfig.showPromoGameTypeByPlatform.get(t).add(e)}else PageConfig.showPromoGameTypeByPlatform.set(t,new Set([e]))})})}t.setAttribute("id","dailyMissionsPageDiv"),t.setAttribute("bonusId",n),t.setAttribute("issueType",1),s.className.split(" ").forEach(function(e){t.classList.add(e)}),PageConfig.isMobile||t.classList.add("iframe-div"),t.safeSelector("#backBtn").setAttribute("bonusId",n),t.safeSelector("#backBtn").setAttribute("presentType","DAILY_MISSION"),t.safeSelector("#bonusDetailBtn").setAttribute("bonusId","dailyMissions"),s.buildResultArea(c,e,t);document.getElementById("gameHallDiv");document.body.appendChild(t)}if(PageConfig.showPromoGameTypeByPlatform){let e=Array.from(PageConfig.showPromoGameTypeByPlatform).map(([e,t])=>[e,Array.from(t)]);localStorage.setItem("showPromoGameTypeByPlatform",JSON.stringify(e))}if(t&&(document.getElementById("rebateDate").innerHTML=`${o(t.toISOString())} - ${o(n.toISOString())}`,PageConfig.rebatePlatformSort&&PageConfig.rebatePlatformSort.length>0)){const e=PageConfig.rebatePlatformSort.split(","),t={};e.forEach((e,n)=>{t[e]=n});const n=$j("#rebateSection");n.children(".REBATE-box").sort((e,n)=>(null==t[$j(e).data("platform")]?999:t[$j(e).data("platform")])-(null==t[$j(n).data("platform")]?999:t[$j(n).data("platform")])).appendTo(n)}if(GameHallUtils.isBS()&&d>0){let e=$j("#bonusEventListSticker");l&&CountDownUtil.countToTime({countArea:e.find("#timeWrapper"),expireTime:l,expireText:"Draw Time",showHours:!0}),e.addClass("num-"+d),e.show()}GameHallUtils.isRWD()&&d>0&&$j("#bonusEventBannerWrapper").addClass("num-"+d),0!=r.length&&BonusEventHandler.getBonusEventRealTimeInfo(r.join(",")),BonusEventHandler.banners.sort((e,t)=>{const n=$j(e).find("#timeStickerWrapper").text().replace(/:/g,""),a=$j(t).find("#timeStickerWrapper").text().replace(/:/g,"");return"Draw Time"==n?1:"Draw Time"==a?-1:parseInt(n)>parseInt(a)?1:parseInt(n)<parseInt(a)?-1:0}),BonusEventHandler.stickers.sort((e,t)=>{const n=$j(e).find("#timeStickerWrapper").text().replace(/:/g,""),a=$j(t).find("#timeStickerWrapper").text().replace(/:/g,"");return"Draw Time"==n?-1:"Draw Time"==a?1:parseInt(n)>parseInt(a)?-1:parseInt(n)<parseInt(a)?1:0});for(let e of BonusEventHandler.banners)document.getElementById("bonusEventBannerWrapper").appendChild(e);let m=document.getElementById("bonusEventListSticker");if(m)for(let e of BonusEventHandler.stickers)e.classList.add("num-"+ ++BonusEventHandler.sideEntryCount),m.appendChild(e);else console.error("bonusEventListSticker doesn't exist");if(!GameHallUtils.isWL()){let e=BonusEventHandler.gameTagIdMap,t=document.getElementById("HTMLTemplate");for(let n in e)if(e.hasOwnProperty(n)){let a=e[n],s=n.split(",")[0],i=n.split(",")[1];GameEleCache.get({platform:s,gameCode:i}).forEach(e=>{if(!GameHallUtils.isBS()||GameHallUtils.isBS()&&"LIVE"===e.getAttribute("gameType")){let n=e.safeSelector("#gameTagArea");for(const s in a)if(!n.querySelector("#"+s)){let a=t.querySelector("#"+s).cloneNode(!0);s===BonusEventPresentHandler.REBATE.gameTagId&&(e.classList.add("show-rebate"),a.safeSelector("#tagRebateRatio").innerHTML=document.getElementById("rebateRatio").innerHTML),n.appendChild(a)}}})}}new Swiper(".swiper-egg",{loop:!0,centeredSlides:!0,slidesPerView:2,slidesPerGroup:1,spaceBetween:0,speed:600,loopedSlides:6,loopFillGroupWithBlank:!0,touchRatio:.5,touchAngle:45,resistanceRatio:1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",clickable:!0},lazy:{loadPrevNext:!0,loadPrevNextAmount:6}}),new Swiper(".swiper-box",{loop:!0,centeredSlides:!0,slidesPerView:1,spaceBetween:0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".swiper-pagination",clickable:!0}}),BonusEventHandler.swiper(PageConfig.gameHallType,PageConfig.isMobile),PageConfig.rebateBonusEntityArr.length>0&&(BonusEventHandler.initialRebateTimer(),setInterval(function(){let e=new Date;0!=e.getMinutes()&&30!=e.getMinutes()||0!=e.getSeconds()||BonusEventHandler.initialRebateTimer()},1e3))}BonusEventHandler.init=function(){BonusTemplatesHandler.init(),e=document.getElementById("bonusEventTemplate"),PageConfig.hasBonusEvent&&BonusEventHandler.queryBonusEvent();let t=0;$j(window).scroll(function(){let e=$j(window).scrollTop();$j(".stickerSliding").toggleClass("show",e>t),t=e})},BonusEventHandler.openTicketList=function(e){BonusEventHandler.getRedeemedBonusTicket(e)},BonusEventHandler.closeTicketList=function(){PopupUtil.closeModal("#bonusTicketList"),$j("#bonusTicketList").find("#bonusTicketWrapper").html("")},BonusEventHandler.getRedeemedBonusTicket=function(t){let n=$j(t).attr("bonusId");postAjax({async:!1,type:"POST",data:{bonusId:n},url:PageConfig.getRedeemedBonusTicket,success:function(t){if(t.error)return alert(t.error),void location.reload();let a=$j(`#PageDiv${n}`),s=a.find("#bonusMultiplier").val()-0,i=a.find("#multiplyExpireHours").val()-0,o=a.find("#redeemDeadlineDate").val()+":00:00",l=$j("#bonusTicketList"),r=0,d=0,c=l.find("#bonusTicketWrapper");if(c.empty(),0==t.length){let t=$j(e).find("#bonusTicketTemplate").clone();t.find("#bonusTxId").html("NO_DATA"),t.find(".txt-bonus").remove(),c.append(t)}let m=a.attr("freeSpinGameLines");t.forEach(function(t){d+=t.bonusAmt;let n=$j(e).find("#bonusTicketTemplate").clone();if(t.multiplyStartTime){if(t.status==PageConfig.ticketStatus.REDEEMED)t.multiplySuccessTime?(n.find("#anotherBonusDesc").append($j(e).find("#challengeSuccessHint").clone()),s>1&&(n.find("#multiplication").text(t.adjustBonusAmt+" x "+s),t.adjustBonusAmt=MathUtil.decimal.multiply(t.adjustBonusAmt,s))):n.find("#anotherBonusDesc").append($j(e).find("#challengeFailHint").clone());else if(t.status==PageConfig.ticketStatus.ACCEPT_CHALLENGE){n.find("#anotherBonusDesc").append($j(e).find("#challengingHint").clone()),s>1&&(n.find("#multiplication").text(t.adjustBonusAmt+" x "+s),t.adjustBonusAmt=MathUtil.decimal.multiply(t.adjustBonusAmt,s));let a=DateUtil.getLocalDate(t.multiplyStartTime);a.setHours(a.getHours()+i);let l=DateUtil.getLocalDate(o);l.getTime()<a.getTime()&&(a=l),CountDownUtil.countToTime({countArea:n.find("#challengeCountDown"),expireTime:a,expireText:"Expired",showHours:!0})}else t.status==PageConfig.ticketStatus.FAIL_CHALLENGE&&(n.find("#anotherBonusDesc").append($j(e).find("#challengeFailHint").clone()),t.adjustBonusAmt=0);s>1&&n.find("#anotherBonusDesc").find("#bonusMultiplierText").text(s+"X")}if(t.rankRewardType){""==n.find("#multiplication").text?n.find("#multiplication").text(t.adjustBonusAmt+" + "+t.rankRewardPercentage+"%"):n.find("#multiplication").text(n.find("#multiplication").text()+" + "+t.rankRewardPercentage+"%"),t.adjustBonusAmt=MathUtil.decimal.multiply(t.adjustBonusAmt,1+t.rankRewardPercentage/100);let a=$j(e).find("#badgeBox").clone();if(a.find("#badgeType").addClass(t.rankRewardType),"daily"===t.rankRewardType){const e=$j('<img src="'+PageConfig.imagePrefix+'/theme/images/src-common/TOURNAMENT-img/DAILY-badge.png" alt=""/>');a.find("#badgeType").prepend(e)}else if("weekly"===t.rankRewardType){const e=$j('<img src="'+PageConfig.imagePrefix+'/theme/images/src-common/TOURNAMENT-img/WEEKLY-badge.png" alt=""/>');a.find("#badgeType").prepend(e)}else{const e=$j('<img src="'+PageConfig.imagePrefix+'/theme/images/src-common/TOURNAMENT-img/MONTHLY-badge.png" alt=""/>');a.find("#badgeType").prepend(e)}n.find("#anotherBonusDesc").append(a)}null==t.multiplyStartTime&&null==t.rankRewardType&&n.find("#anotherBonusDesc").remove(),n.find("#ticketRowId").html(++r),n.find("#bonusTxId").html(t.txnId),n.find("#ticketUpdateTime").html(t.updateTime);let l=parseInt(t.freeSpinCount);if(l>0){let e=parseInt(t.remainCount),s=l-e,i=MathUtil.decimal.multiply(m,MathUtil.decimal.multiply(t.freeSpinBaseAmt,t.freeSpinMultiplier));i=MathUtil.decimal.multiply(i,l),n.find("#spinCount").text(s),n.find("#freeSpinCount").text(t.freeSpinCount),n.find("#freeSpinAmt").text(i);let o=n.find("#freeSpinBox");e>0?(o.attr("game_code",t.gameCode),o.attr("gameType",t.gameType),o.attr("platform",a.attr("platform"))):(o.attr("onclick",""),o.addClass("is-success")),o.show()}n.find("#txnBonusDiv").show(),n.find("#ticketBonusAmt").html(NumberFormatUtil.formatNumber(t.adjustBonusAmt,2)),c.append(n)}),PopupUtil.openModal("#bonusTicketList")},beforeSend:function(){PopupUtil.openModal("#loadingMask")},complete:function(){PopupUtil.closeModal("#loadingMask")}})},BonusEventHandler.getBonusEventRealTimeInfo=function(e){let t=e.split(","),n=[];PageConfig.jspBonusEvents.forEach(function(e){t.includes(e.bonusId)&&("REBATE"==e.presentType&&$j(`#PageDiv${e.bonusId}`).find("#eventTurnover").html("0").addClass(PageConfig.playerCurrency),"DAILY_MISSION"!==e.presentType?s.push(e.bonusId):n.push(e),"REBATE"!==e.presentType&&"DAILY_MISSION"!==e.presentType&&function(e,t){let n=$j(`#PageDiv${t}`);if(n.attr("ticketCount",e.ticketCount),n.attr("challengeCount",e.challengeCount),n.find("#ticketCountSpan").html(e.ticketCount),n.addClass("active"),e.hasOwnProperty("playerPoint")){n.addClass("bonusPoints");const a=NumberFormatUtil.formatNumber(e.playerPoint.toString(),0);if(0===n.find(".bonusPoints-entrance").length){let e=document.getElementById("bonusPointTemplate").content.cloneNode(!0);e.id=t+"_pont",e.querySelector("#point").textContent=a,n.prepend(e)}else n.find(".bonusPoints-entrance #point")[0].textContent=a;let s=n.find("#shopBtn")[0];s&&s.setAttribute("canShowMall",e.canShowMall)}else n.removeClass("bonusPoints"),n.find(".bonusPoints-entrance").remove();$j("body").addClass("bonusevent-open");let a=BonusEventPresentHandler.getHandler(e.presentType);if($j('.page-backdrop[bonusid="'+t+'"]').addClass("show"),"500"==e.status)return void n.find("#bonusTurnoverDes").html("Whoops, something went wrong, please contact your upline.");if(GameHallUtils.isRWD()||GameHallUtils.isWL())!e.isFreeSpinEvent&&n.find("#freeSpinSticker").length>0&&n.find("#freeSpinSticker").remove();else if(e.isFreeSpinEvent&&0==n.find("#innerFreeSpinStiker").length&&"DAILY_MISSION"!=e.presentType&&FreeSpinHandler)if(GameHallUtils.isBS()&&Object.keys(FreeSpinHandler.freeSpinData).length>0){let e=`<div class="freeSpinTag BS freespin-total" id="innerFreeSpinStiker" onclick="PopupUtil.openModal('#freeSpinList')">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img src="${PageConfig.imagePrefix}/theme/images/src-common/BONUSEVENT-img/FREESPIN/freeSpinTag_bs.webp" alt="freeSpinTag">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="txt-balance ${PageConfig.playerCurrency}">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t${$j("#freeSpinTotalBalance").text()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>`;n.prepend(e)}else n.prepend(FreeSpinHandler.cloneSticker());"true"==e.isEnd?n.find("#bonusTurnoverDes").html("All tickets must redeem before "+e.redeemDeadlineDateDesc):(n.find("#eventTurnover").html(NumberFormatUtil.formatNumber(e.eventTurnover,2)).addClass(PageConfig.playerCurrency),n.find("#todayTickets").html(NumberFormatUtil.formatNumber(e.todayTickets,0)),n.find("#todayRedeemedTickets").html(NumberFormatUtil.formatNumber(e.todayRedeemedTickets,0)),n.find("#needMoreTurnover").html(NumberFormatUtil.formatNumber(e.needMoreTurnover,2)).addClass(PageConfig.playerCurrency),n.find("#earnTicket").html(parseInt(e.todayTickets)<parseInt(e.maxTicketPerPlayer)?"1":"0"));if("MARIOSLOT"===e.presentType){let t=n[0].safeSelector("#startBtn");t.setAttribute("style","");for(const e of n[0].safeSelector("#marioSlotPresentTemplate").children)e.classList.remove("active");if(e.remark){let s=a.genBoard(e.remark);t.setAttribute("style","transform: translateX("+s.translateX+"px) translateY("+s.translateY+"px);"),n.find("#roll-button").attr("startPos",e.remark);let i=n.data("minigame");e.remark==PageConfig.marioSlotChanceIndex&&i?n[0].safeSelector("#marioSlotRoad-"+e.remark).classList.add("default"):n[0].safeSelector("#marioSlotRoad-"+e.remark).classList.add("active")}else n.find("#roll-button").attr("startPos","0")}if("DAILY_MISSION"===e.presentType)a.handleDailyMission(e,n),n[0].safeSelector("#cumulativeInfo").onclick=function(){this.classList.add("show");let t=$j(`#PageDiv${e.bonusId}`).find("#dailyBackdrop");t.addClass("show"),t.data("taskid","PageDiv"+e.bonusId)};else if("GOLDEN_EGG"==e.presentType){let t=parseInt(e.ticketCount),a=e.skinName;n.find(`.copper${a}`).toggleClass("disable",t<1),n.find(`.silver${a}`).toggleClass("disable",t<10),n.find(`.gold${a}`).toggleClass("disable",t<100)}if(e.takenTicketId){BonusEventHandler.showChallengeChoiceDiv(e,t);let n=$j("#challengeChoiceDiv");n.data("response",e),n.data("formData",{bonusId:t,pickedBox:e.remark,rankRewardPercentage:e.rankRewardPercentage||""})}}(e,e.bonusId))}),n.sort((e,t)=>new Date(t.updateTime)-new Date(e.updateTime)),0!=n.length&&function(e){let t=$j("#dailyMissionsPageDiv"),n=BonusEventPresentHandler.getHandler("DAILY_MISSION");t.addClass("active"),totalTicketCount=e.reduce((e,t)=>e+(parseInt(t.ticketCount,10)||0),0),t.attr("ticketCount",totalTicketCount);let a=!1,s=!1,i=200,o="",l=!1,r=0;for(const t of e)!a&&t.hasOwnProperty("playerPoint")&&(a=!0,r=NumberFormatUtil.formatNumber(t.playerPoint.toString(),0)),s||(s=t.canShowMall),l||(l=t.isFreeSpinEvent),200!=t.status&&(i=t.status),o+=(o?",":"")+t.bonusId;if(a){if(t.addClass("bonusPoints"),0===t.find(".bonusPoints-entrance").length){let e=document.getElementById("bonusPointTemplate").content.cloneNode(!0);e.id=bonusId+"_pont",e.querySelector("#point").textContent=r,t.prepend(e)}else t.find(".bonusPoints-entrance #point")[0].textContent=r;let e=t.find("#shopBtn")[0];e&&e.setAttribute("canShowMall",s)}else t.removeClass("bonusPoints"),t.find(".bonusPoints-entrance").remove();if($j("body").addClass("bonusevent-open"),$j('.page-backdrop[bonusid="'+o+'"]').addClass("show"),"500"==i)return void t.find("#bonusTurnoverDes").html("Whoops, something went wrong, please contact your upline.");if(GameHallUtils.isRWD()||GameHallUtils.isWL())!l&&t.find("#freeSpinSticker").length>0&&t.find("#freeSpinSticker").remove();else if(l&&0==t.find("#innerFreeSpinStiker").length&&window.FreeSpinHandler)if(GameHallUtils.isBS()){if(Object.keys(FreeSpinHandler.freeSpinData).length>0){let e=`<div class="freeSpinTag BS" id="innerFreeSpinStiker" onclick="PopupUtil.openModal('#freeSpinList')">\n\t\t\t\t\t\t\t\t<img src="${PageConfig.imagePrefix}/theme/images/src-common/BONUSEVENT-img/FREESPIN/freeSpinTag_bs.webp" alt="freeSpinTag">\n\t\t\t\t\t\t\t\t<div class="txt-balance freespin-total ${PageConfig.playerCurrency}">\n\t\t\t\t\t\t\t\t${$j("#freeSpinTotalBalance").text()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>`;t.prepend(e)}}else if(GameHallUtils.isEZ()){if(Object.keys(FreeSpinHandler.freeSpinData).length>0){let e=`<div class="freeSpinTag EZ" id="innerFreeSpinStiker" onclick="GameHallHandler.clickFreeSpinSticker()">\n\t\t\t\t\t\t\t\t<img src="${PageConfig.imagePrefix}/theme/images/src-common/BONUSEVENT-img/FREESPIN/freeSpinTag_ez.webp" alt="freeSpinTag">\n\t\t\t\t\t\t\t\t<div id="freeSpinTotalAmt" class="txt-balance freespin-total ${PageConfig.playerCurrency}">\n\t\t\t\t\t\t\t\t${GameHallHandler.freeSpinTotalAmt}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>`;t.prepend(e)}}else t.prepend(FreeSpinHandler.cloneSticker());n.handleDailyMission(e,t);for(const n of e)t.find(`#PageDiv${n.bonusId}`).find("#cumulativeInfo").on("click",function(){this.classList.add("show");let e=$j("#dailyMissionsPageDiv").find("#dailyBackdrop");e.addClass("show"),e.data("taskid",n.bonusId+"Div")})}(n)},BonusEventHandler.toggleBonusEvent=function(e){let t=$j(e).attr("presentType");if("REBATE"==t)PopupUtil.openModal("#Rebate-POP");else{GameHallUtils.isBS()&&$j("#bonusPopupCloseBtn").click();let n,a=$j(e).attr("bonusId");n="DAILY_MISSION"==t?$j("#dailyMissionsPageDiv"):$j(`#PageDiv${a}`),n.find("#innerFreeSpinStiker").remove(),n.hasClass("active")?(n.removeClass("active"),n.find("#ticketAmtWrapper").text("0"),PageConfig.isMobile&&(n.find("#defaultBonusResult").show(),n.find("#winBonusResult").hide(),n.removeClass("shiftGame")),0==$j(".page-bonus-div.active").length&&($j("#gameHallChallengeSizesDesc").hide(),$j("body").removeClass("bonusevent-open"),PageConfig.isMobile&&$j("#modalSlotGame").hide()),$j('.page-backdrop[bonusid="'+a+'"]').removeClass("show")):BonusEventHandler.getBonusEventRealTimeInfo(a)}},BonusEventHandler.closeAllBonusEvents=function(){GameHallUtils.isBS()&&$j(".modalBonusEvent").each(e=>{$j(e).find("#bonusPopupCloseBtn").click()}),$j(".page-bonus-div.active").removeClass("active"),$j(".page-backdrop.show").removeClass("show"),0==$j(".page-bonus-div.active").length&&($j("body").removeClass("bonusevent-open"),PageConfig.isMobile&&$j("#modalSlotGame").hide())},BonusEventHandler.openToastAlert=function(e){let t="";e.bonusAmt>0&&(t=`<span class="txt-info">${I18N.get("totalBonus")}</span>\n\t\t\t\t\t\t\t<span class="txt-bonus ${PageConfig.chosenCurrency}">${NumberFormatUtil.formatNumber(e.bonusAmt,2)}</span>`),e.freeSpinAmt>0&&(t+=`<span class="txt-info">${I18N.get("totalFreeSpin")}</span>\n\t\t\t\t\t\t\t<span class="txt-bonus freeSpin ${PageConfig.playerCurrency}">${NumberFormatUtil.formatNumber(e.freeSpinAmt,2)}</span>`),$j("#toastMessage").html(t),$j("#toastPlatformImg").attr("src",`${PageConfig.imagePrefix}/theme/images/src-common/PLATFORM-img/100x100/${e.platform}-logo.webp`),$j("#toastTicketCounts").text(e.ticketCount),$j("#toastAlert").toast("show")},BonusEventHandler.openFancyAlert=function(e,t,n){let a=$j("#fancyAlert");if(a.attr("bonusId",e),a.attr("class","function-alert"),$j("#fancyAlertMsg").html(t),a.find("#goldBgImg").show(),a.find("#lightBgImg").show(),n&&n.length>0){for(let e of n)a.addClass(e);if(n.includes("freeSpin")){const e=$j('<img class="freespins-bg" src="'+PageConfig.imagePrefix+'/theme/images/src-common/BONUSEVENT-img/FREESPIN/freespins-bg.webp" alt="">');$j("#fancyAlertMsg").append(e),a.find("#goldBgImg").hide(),a.find("#lightBgImg").hide(),$j("#fancyAlertMsg .freespins-bg").on("load",()=>{a.addClass("show")})}else a.find("#goldBgImg").show(),a.find("#lightBgImg").show(),$j("#fancyAlertMsg").find(".freespins-bg").remove(),a.addClass("show")}$j("#fancyAlert").data("lastAlertTime",Date.now())},BonusEventHandler.openMultiAlert=function(e,t,n){if($j("#fancyAlert").attr("bonusId",e),$j("#fancyAlert").attr("class","function-alert"),$j("#fancyAlertMsg").html(t),n&&n.length>0){for(let e of n)$j("#fancyAlert").addClass(e);if(n.includes("FreeSpins")){const e=$j('<img class="freespins-bg" src="'+PageConfig.imagePrefix+'/theme/images/src-common/BONUSEVENT-img/FREESPIN/freespins-bg.webp" alt="">');$j("#fancyAlertMsg").append(e),$j("#fancyAlertMsg .freespins-bg").on("load",()=>{$j("#fancyAlert").addClass("show")})}else $j("#fancyAlertMsg").find(".freespins-bg").remove(),$j("#fancyAlert").addClass("show")}$j("#fancyAlert").data("lastAlertTime",Date.now())},BonusEventHandler.closeFancyAlert=function(){let e,t=$j("#fancyAlert").attr("bonusId");e="DAILY_MISSION"===$j("#fancyAlert").attr("presentType")?$j("#dailyMissionsPageDiv"):$j(`#PageDiv${t}`);let n=BonusEventPresentHandler.getHandler(e.attr("presentType"));n&&n.onCloseFancyAlert(e),$j("#fancyAlert").attr("class","function-alert"),$j("#fancyAlert").html('\n\t\t\t\t<div class="txt">\n\t\t\t\t\t<span id="fancyAlertMsg"></span>\n\t\t\t\t</div>\n\t\t\t\t<img id="goldBgImg" class="slot-s" src="'+PageConfig.imagePrefix+'/theme/images/src-common/BONUSEVENT-img/bonus-win-gold.webp" alt=""/>\n\t\t\t\t<img id="lightBgImg" class="toast-bg" src="'+PageConfig.imagePrefix+'/theme/images/src-common/BONUSEVENT-img/toast-bg.webp" alt=""/>\n\t\t'),$j("#fancyAlert").attr("onclick","BonusEventHandler.closeDelayFancyAlert(1500)"),$j("#fancyAlert").removeAttr("bonusId")},BonusEventHandler.closeDelayFancyAlert=function(e){let t=$j("#fancyAlert").data("lastAlertTime"),n=Date.now();n-t>e&&($j("#fancyAlert").data("lastAlertTime",n),BonusEventHandler.closeFancyAlert())},BonusEventHandler.eggConfirm=function(e,t){if($j(e).hasClass("disable"))return;let n=$j(e).attr("eggType");if("copper"==n)return void BonusEventHandler.takeTicket(e,!1);$j("#eggConfirmYesBtn").off("click"),$j("#eggConfirmYesBtn").on("click",function(){BonusEventHandler.takeTicket(e,!1),$j("#eggConfirm").removeClass("show")});let a=`Are you sure you want to redeem a ${n.toUpperCase()} ${t} ?`;$j("#eggMsg").text(a),$j("#eggConfirm").show().addClass("show")},BonusEventHandler.takeTicketLock=!1,BonusEventHandler.takeTicket=function(e,t,n){if(PageConfig.isAppTakeTicketOnly&&!PageConfig.isApp&&PageConfig.isShowDownloadApp)return void(confirm("Redeem tickets by APP only!! Confirm to download.")&&(location.href=PageConfig.downloadAppUrl));if(BonusEventHandler.takeTicketLock)return;BonusEventHandler.takeTicketLock=!0;let a=$j(e).attr("bonusId"),s=$j(`#PageDiv${a}`);if(s.attr("ticketCount")<=0)return void(BonusEventHandler.takeTicketLock=!1);let i="";if(1==s.find("#rewardType").find(".active").length&&(i=s.find("#rewardType").find(".active").data("rewardtype"),parseInt(s[0].safeSelector("#"+i+"RewardCnt").innerText)<=0))return BonusEventHandler.takeTicketLock=!1,void alert("your "+i+" rank reward is 0 !!");let o={bonusId:a,isTakeAll:t,pickedBox:n,rankReward:i,eggType:$j(e).attr("eggType")},l=BonusEventPresentHandler.getHandler(s.attr("presentType")),r="";postAjax({async:!0,type:"POST",data:o,timeout:3500,url:PageConfig.takeBonusTicket,beforeSend:function(){l.beforeAjax(s,e)},success:function(t){if(null==t||$j.isEmptyObject(t)||t.error)return t.error?alert(t.error):alert("Error occurred, please refresh and try again later !"),void location.reload();s.attr("ticketCount",t.ticketCount),s.attr("challengeCount",t.challengeCount),s.find("#ticketCountSpan").text(t.ticketCount);let n=s.find("#todayTickets").text();n&&n>t.ticketCount&&s.find("#todayRedeemedTickets").text(n-t.ticketCount);let i=s.find("#point");void 0!==t.vipPoints&&i.length>0&&i.text(NumberFormatUtil.formatNumber(t.vipPoints,0)),l.takeTicketProcess(s,t,o).then(()=>new Promise(e=>{l.playMiniGame(s,t,o).then(()=>{e()})})).then(()=>{if(o.rankRewardPercentage=t.rankRewardPercentage||"",t.challengingTicketId)l.takeTicketResult(s,t,o,e).then(()=>{let e=t.award;t.rankRewardPercentage&&(e=MathUtil.decimal.add(t.award,t.rankRewardAmount));let n=MathUtil.decimal.multiply(e,s.find("#bonusMultiplier").val()),i=MathUtil.decimal.multiply(n,s.find("#turnoverMultiplier").val());n=NumberFormatUtil.formatNumber(n,-1),i=NumberFormatUtil.formatNumber(i,2),$j("#fancyAlert").attr("class","challenge-winning function-alert demo-win show"),r=' <div class="challenge-bg bg-top">     <img src="'+PageConfig.imagePrefix+'/theme/images/src-common/BONUSEVENT-img/CHALLENGE/challenge-bg_top.webp" alt=""></div> <div class="challenge-bg bg-bottom">     <img src="'+PageConfig.imagePrefix+'/theme/images/src-common/BONUSEVENT-img/CHALLENGE/money.webp" alt=""></div> <div class="challenge-btn btn-close" onclick="BonusEventHandler.closeDelayFancyAlert(1500)"> <i class="icon-close"></i>  </div> <div class="challenge-content" id="challengeAlterContent"></div> <div class="gamesList-title">  <span class="deco-line line-left"></span>  <span> '+I18N.get("challengeGameList",[])+' </span>  <span class="deco-line line-right"></span>  </div><div class="challenge-area sticky"><div class="challenge-items">',$j.each(t.challengeGamePlatforms,function(e,t){let n=PageConfig.imagePrefix+"/theme/images/src-common/PLATFORM-img/100x100/"+t+"-logo.webp",s=PageConfig.platformMainGameType[t]||"SLOT";r+=`<div class="item" platform="${t}"\n\t\t\t\t\t\t\t\t\t\t\tgametype="${s.toLowerCase()}"\n\t\t\t\t\t\t\t\t\t\t\tbonusid="${a}"\n\t\t\t\t\t\t\t\t\t\t\tonclick="GameHallHandler.openLoginPopup(this)" >\n\t\t\t\t\t\t\t\t\t\t\t<img class="icon-${t}" src="${n}" alt="">\n\t\t\t\t\t\t\t\t\t\t</div>`}),r+="</div></div>",$j("#fancyAlert").html(r),$j("#fancyAlert").data("lastAlertTime",Date.now()),$j("#fancyAlert").attr("onclick",""),$j("#challengeGame").find("li").click(function(){BonusEventHandler.closeFancyAlert()}),$j("#fancyAlert").find("#challengeAlterContent").append($j(I18N.get("gotChallenge",[PageConfig.playerCurrency,i,PageConfig.playerCurrency,n]))).find(".content-img").prepend($j('<img src="'+PageConfig.imagePrefix+'/theme/images/src-common/BONUSEVENT-img/CHALLENGE/congrat-1.png" alt="">')),$j("#fancyAlert").find("#challengeAlterContent .txt-bonus").append($j('<img src="'+PageConfig.imagePrefix+'/theme/images/src-common/BONUSEVENT-img/CHALLENGE/banknote.webp" alt="">'))}),BonusEventHandler.getBonusEventRealTimeInfo(a);else if(t.takenTicketId){BonusEventHandler.showChallengeChoiceDiv(t,a);let e=$j("#challengeChoiceDiv");e.data("response",t),e.data("formData",o)}else l.takeTicketResult(s,t,o,e)})},complete:function(){l.afterAjax(s)},error:function(e,t,n){l.ajaxError(s,a)}})},BonusEventHandler.queryBonusEvent=function(){PageConfig.jspBonusEvents?l(PageConfig.jspBonusEvents):(console.time("queryBonusEvent"),postAjax({async:!0,type:"POST",url:PageConfig.queryBonusEvent,success:function(e){null==e||$j.isEmptyObject(e)||e.error?e.error&&alert(e.error):l(e)},beforeSend:function(){console.time("queryBonusEventMask"),PopupUtil.openModal("#loadingMask")},complete:function(){console.timeEnd("queryBonusEventMask"),PopupUtil.closeModal("#loadingMask")}}),console.timeEnd("queryBonusEvent"))},BonusEventHandler.initialRebateTimer=function(){let e,t=function(){let e=new Date,t=(new Date).setDate(e.getDate()+1),n=(new Date).getTimezoneOffset(),a=parseFloat(MathUtil.decimal.divide(n,60)),s=!1,i=!1,o=new Date(2099,11,25,12,0,0),l=new Date(2099,11,25,12,0,0);for(let n=0;n<PageConfig.rebateBonusEntityArr.length;n++){let r=PageConfig.rebateBonusEntityArr[n];if(r.activeHoursPeriodList.length>0){let n=DateUtil.getLocalDate(r.startDate+":00:00"),d=!1;for(let c=0;c<r.activeHoursPeriodList.length;c++){let m,u=r.activeHoursPeriodList[c],p=u.startHour,g=u.endHour,f=new Date(e);f.setHours(p,0,0),f.addHours(-8-a),p>g?(m=new Date(t),m.setHours(g,0,0)):(m=new Date(e),m.setHours(g,0,0)),m.addHours(-8-a),e>=f&&e<m&&e>=n&&(s=!0,d=!0,o=o<m?o:m);let b=new Date(f);b.addHours(-2);let v=new Date(n);v.addHours(-2),e>=v&&e>=b&&e<f&&f>=n&&(i=!0);let y=l<f?l:f;l=y>=n&&y>=e?y:l}let c="PageDiv"+r.bonusId,m=$j("#"+c);d?(m.removeClass("coming-soon"),m.find("#comingSoonTxt").hide(),m.find("#activeHoursPeriodDiv li").each(function(){$j(this).removeClass("on");let t=parseInt($j(this).attr("period-start")),n=parseInt($j(this).attr("period-end")),a=parseInt(e.getHours()+""+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes()));t>n?(a>=t||a<n)&&$j(this).addClass("on"):a>=t&&a<n&&$j(this).addClass("on")})):(m.addClass("coming-soon"),m.find("#comingSoonTxt").show(),m.find("#activeHoursPeriodDiv li").each(function(){$j(this).removeClass("on")}))}else{let t=DateUtil.getLocalDate(r.endDate+":00:00"),n=DateUtil.getLocalDate(r.startDate+":00:00");o=o>t?t:o;let a=new Date(n);a.addHours(-2),e>=a&&(i=!0),l=l<n?l:n,e>=n&&e<t&&(s=!0)}}let r=new Map;return r.set("closestActiveStartDate",l),r.set("closestActiveEndDate",o),r.set("isActiveNow",s),r.set("isShowComingSoon",i),r}(),n=t.get("closestActiveStartDate"),a=t.get("closestActiveEndDate"),s=t.get("isActiveNow"),i=t.get("isShowComingSoon");s?($j("#rebateSticker").removeClass("coming-soon"),$j("#rebateSticker").show(),e=a):i?($j("#rebateSticker").addClass("coming-soon"),$j("#rebateSticker").show(),e=n):($j("#rebateSticker").hide(),$j("#rebateModalCloseBtn").click()),GameHallUtils.isBS()&&(s?$j("#rebateSticker").find("img.stickerimg").attr("src",PageConfig.rebateBSRebateNowImg):i&&$j("#rebateSticker").find("img.stickerimg").attr("src",PageConfig.rebateBSComingSoonImg)),e&&CountDownUtil.countToTime({countArea:$j("#rebateSticker").find("#timeStickerWrapper"),expireTime:e,expireText:"Draw Time",showHours:!0,wrapSpan:!0})},BonusEventHandler.sideEntryCount=0;let r=0,d=0;BonusEventHandler.buildEntrance=function(t,n,a){let s;if("REBATE"==t.presentType){d++;let n='<div class="platform-img '+t.platform+'"><img src="'+PageConfig.imagePrefix+"/theme/images/src-common/PLATFORM-img/100x100/"+t.platform+'-logo.webp"></div>';if(r<1){if(s=e.safeSelector("#rebateStickerTemplate").cloneNode(!0),s.setAttribute("id","rebateSticker"),s.setAttribute("presentType","REBATE"),s.safeSelector("#stickerRebateRatio").innerHTML=`+${t.prizeJson.rebateRatio}%`,s.safeSelector("#comingSoonPlatform").innerHTML=n,GameHallUtils.isBS()){document.getElementById("subMenu").appendChild(s);let e=$j("#subMenu");e.is(":visible")||e.show(),r++}else{let e=document.getElementById("bonusEventListSticker");e?(e.appendChild(s),r++):console.error("bonusEventListSticker doesn't exist")}return s}return s=$j("#rebateSticker"),s.find("#comingSoonPlatform").append(n),void $j("#rebateSticker").find("#comingSoonPlatform").removeClass().addClass("show-platform num-"+d)}if(GameHallUtils.isWL()){s=document.createElement("a"),s.href="javascript:void(0);","GOLDEN_EGG"==t.presentType?s.className=`bonusEvent GOLDEN_${t.skinName.toUpperCase()}`:s.className=`bonusEvent ${t.presentType}`,s.setAttribute("onclick","BonusEventHandler.toggleBonusEvent(this)");let e=t.presentType,n=`${PageConfig.imagePrefix}/theme/images/src-common/PLATFORM-img/100x100/${t.platform}-logo.webp`,a="";if("GOLDEN_EGG"==e)a=`${PageConfig.imagePrefix}/theme/images/src-common/BONUSEVENT-img/GOLDENEGG/${t.skinName.toUpperCase()}/gold${t.skinName}-WL.webp`;else if("MARIOSLOT"!==e){let t=e.split("_")[0];const n=t+"/"+t.toLowerCase();a=`${PageConfig.imagePrefix}/theme/images/src-common/BONUSEVENT-img/${n}-WL.webp`}else a=`${PageConfig.imagePrefix}/theme/images/src-common/BONUSEVENT-img/MARIO/mario-WL.webp`;let i,o=`\n\t\t\t\t\t\t<div class="show-instant"></div>\n\t\t                <i class="txt-platform-name">\n\t\t                    <img src="${n}" />\n\t\t                </i>\n\t\t                <img src="${a}" alt="" />\n\t\t                <div class="show-bonus-event">\n\t\t                    <div class="txt" id="timeStickerWrapper">\n\t\t                        ::\n\t\t                    </div>\n\t\t                </div>`;s.innerHTML=o,s.setAttribute("id",t.bonusId+"Div"),s.setAttribute("bonusId",t.bonusId);let l=t.requiredGameList.reduce((e,t)=>(e[t.gameType]||(e[t.gameType]=[]),e[t.gameType].push(t),e),{});const r=Object.keys(l);let d=0;r.forEach(e=>{const n=l[e];if(n.length>0){let a={imagePrefixPath:PageConfig.imagePrefix,eventTimeDesc:t.eventTimeDesc,grandPrize:NumberFormatUtil.formatNumber(t.grandPrize,0),currency:PageConfig.playerCurrency,platform:t.platform,gameType:e,bonusId:t.bonusId,numClass:n.length,targetIndex:d++};if(i=$j(TemplateCache.renderTemplate("bonusEventItemWL",a)),$j("#bonusEvent_"+e).append(i),t.isEnd)$j("#bonusEventGroup_"+e+"_"+t.bonusId).find("#timeStickerWrapper").innerHTML="<span>Draw Time</span>";else{let n=DateUtil.getLocalDate(t.endDate+":00:00");CountDownUtil.countToTime({countArea:$j("#bonusEventGroup_"+e+"_"+t.bonusId).find("#timeStickerWrapper"),expireTime:n,expireText:"Draw Time",showHours:!0,wrapSpan:!0})}n.forEach(n=>{GameHallHandler.buildGame(n,$j(`#${t.bonusId}${e}UlGameList`)[0],e,"bonusEvent",!1)})}})}else if(GameHallUtils.isBS()){s=document.createElement("a"),"GOLDEN_EGG"==t.presentType?s.className=`btn GOLDEN_${t.skinName.toUpperCase()}`:s.className=`btn ${t.presentType}`,s.setAttribute("onclick","BonusEventHandler.toggleBonusEvent(this)");let e=' <i id="imgPlatformLogo" class="img-platform-logo">\n\t\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t\t<div class="show-bonus-event">\n\t\t\t\t\t\t\t\t\t<div class="txt" id="timeStickerWrapper">\n\t\t\t\t\t\t\t\t\t\t::\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>';s.innerHTML=e,GameHallUtils.setPlatformImg(s,"#imgPlatformLogo",t.platform)}else if(t.userEntryType==PageConfig.entryType.sticker)"REBATE"!=t.presentType&&(s=e.safeSelector("#bonusEventStickerTemplate").cloneNode(!0));else if(t.userEntryType==PageConfig.entryType.banner){let e="";if(t.requiredGameList.forEach(function(t){e+='<img src="'+GameHallUtils.getImgUrl(t)+'">'}),!GameHallUtils.isNEW()&&!GameHallUtils.isOLD()||PageConfig.isMobile){if(GameHallUtils.isNEW()){s=document.createElement("div"),s.className="swiper-slide BONUSEVENT",s.setAttribute("onclick","BonusEventHandler.toggleBonusEvent(this)");let t='<div class="swiper-slide BONUSEVENT"><li class="fix-sticker img-upload"><div class="show-bonus-event"><div class="txt" id="timeStickerWrapper">::</div></div><div class="txt-bonus"><small>'+I18N.get("player.bonusEvent.text.totalBonus")+'</small><sup class="'+PageConfig.playerCurrency+'"></sup><b id="stickerTotalBonus"></b></div><div class="event-games">'+e+"</div></li></div>";s.innerHTML=t}else if(GameHallUtils.isOLD()){s=document.createElement("div"),s.className="swiper-slide BONUSEVENT",s.setAttribute("onclick","BonusEventHandler.toggleBonusEvent(this)");let t='<div class="swiper-slide"><li class="fix-sticker img-upload"><div class="show-bonus-event"><div class="txt" id="timeStickerWrapper">::</div></div><div class="txt-bonus"><small>'+I18N.get("player.bonusEvent.text.totalBonus")+'</small><sup class="'+PageConfig.playerCurrency+'"></sup><b id="stickerTotalBonus"></b></div><div class="event-games">'+e+"</div></li></div>";s.innerHTML=t}else if(GameHallUtils.isRWD()){let e="";e="GOLDEN_EGG"===t.presentType&&t.skinName?`GOLDEN_${t.skinName.toUpperCase()}`:`${t.presentType}`,s=document.createElement("li"),s.className=t.platform,s.setAttribute("onclick","BonusEventHandler.toggleBonusEvent(this)"),s.innerHTML='<div class="card"><div class="show-platform-logo"><img src="https://img.mpsimg.com/theme/images/src-common/PLATFORM-img/120x80-fullname/'+t.platform+'-logo.webp"></div><div class="show-bonus-event '+e+'"></div><div class="card-tit"><div class="txt-bonus-tit">'+I18N.get("player.bonusEvent.text.totalBonus")+'</div><div class="txt-bonus '+PageConfig.playerCurrency+'"><b id="stickerTotalBonus"></b></div></div><div class="txt-clock" id="timeStickerWrapper">::</div></div>'}else if(GameHallUtils.isEZ()){let e="";e="GOLDEN_EGG"===t.presentType&&t.skinName?`GOLDEN_${t.skinName.toUpperCase()}`:`${t.presentType}`,s=document.createElement("div"),s.className="BONUSEVENT",s.setAttribute("onclick","BonusEventHandler.toggleBonusEvent(this)"),s.innerHTML=`<li class="fix-sticker">\n\t\t\t\t\t\t<div class="bonus-event-bg ${e}">\n\t\t\t\t\t\t\t<div class="show-platform-logo">\n\t\t\t\t\t\t\t\t<img src="${PageConfig.imagePrefix}/theme/images/src-common/PLATFORM-img/100x100/${t.platform}-logo.webp">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="show-bonus-event">\n\t\t\t\t\t\t\t\t<div class="txt" id="timeStickerWrapper">::</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="txt-bonus">\n\t\t\t\t\t\t\t\t<small>${I18N.get("player.bonusEvent.text.totalBonus")}</small>\n\t\t\t\t\t\t\t\t<sup class="${PageConfig.playerCurrency}"></sup>\n\t\t\t\t\t\t\t\t<b id="stickerTotalBonus"></b>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>`}}else{s=document.createElement("li"),s.className="fix-sticker img-upload",s.setAttribute("onclick","BonusEventHandler.toggleBonusEvent(this)");let t='<div class="show-bonus-event"><div class="txt" id="timeStickerWrapper">::</div></div><div class="txt-bonus"><small>'+I18N.get("player.bonusEvent.text.totalBonus")+'</small><sup class="'+PageConfig.playerCurrency+'"></sup><b id="stickerTotalBonus"></b></div><div class="event-games">'+e+"</div>";s.innerHTML=t}}if(t.isStickerSliding&&!GameHallUtils.isBS()&&s.classList.add("stickerSliding"),GameHallUtils.isBS()||GameHallUtils.isWL());else if(t.userEntryType==PageConfig.entryType.sticker){if("REBATE"!=t.presentType){s.classList.add(t.platform);let e=s.safeSelector(".show-bonus-event");e.classList.add("GOLDEN_EGG"===t.presentType?`GOLDEN_${t.skinName.toUpperCase()}`:t.presentType);const n=`  \n\t\t\t\t<div class="show-platform-logo">  \n\t\t\t\t\t<img src="${PageConfig.imagePrefix}/theme/images/src-common/PLATFORM-img/100x100/${t.platform}-logo.webp">\n\t\t\t\t</div>  \n\t\t\t\t`;e.insertAdjacentHTML("beforebegin",n)}}else if(t.userEntryType==PageConfig.entryType.banner){let e=t.bannerUrl;GameHallUtils.isEZ()||(PageConfig.isMobile?s.safeSelector(".img-upload").setAttribute("style",'background-image: url("//'+e+'")'):s.setAttribute("style",'background-image: url("//'+e+'")'))}if(s.setAttribute("id",t.bonusId+"Div"),s.setAttribute("bonusId",t.bonusId),s.safeSelector("#stickerTotalBonus").innerHTML=NumberFormatUtil.formatNumber(t.grandPrize,0),t.userEntryType==PageConfig.entryType.sticker?BonusEventHandler.stickers.push(s):t.userEntryType==PageConfig.entryType.banner&&(document.getElementById("bonusEventHomeArea").style.display="block",BonusEventHandler.banners.push(s)),t.isEnd)s.safeSelector("#timeStickerWrapper").innerHTML="<span>Draw Time</span>";else{let e=DateUtil.getLocalDate(t.endDate+":00:00");CountDownUtil.countToTime({countArea:$j(s).find("#timeStickerWrapper"),expireTime:e,expireText:"Draw Time",showHours:!0,wrapSpan:!0})}return s},BonusEventHandler.buildSignupEntrance=function(t){let n=e.safeSelector("#bonusEventSignupTemplate").cloneNode(!0);$j(n).find("#dateStickerWrapper").text(t.startDate+" ~ "+t.endDate),n.setAttribute("id",t.bonusId+"Div"),n.setAttribute("bonusId",t.bonusId),document.body.appendChild(n)},BonusEventHandler.swiper=function(e,t){console.time("swiper");let n,a=$j("#bonusEventBannerWrapper").children().length;if(a<=0)return void console.timeEnd("swiper");let s=!0;if(t||(n=GameHallUtils.isNEW()||GameHallUtils.isOLD()?4:3,s=a>n,s||(GameHallUtils.isNEW()||GameHallUtils.isOLD()?$j("#bonusEventHomeArea").addClass("num-"+a):GameHallUtils.isRWD()||$j("#bonusEventHomeArea").find(".game-list-ul").addClass("num-"+a))),GameHallUtils.isOLD()){new Swiper("section.BONUSEVENT .swiper",{grabCursor:!0,centeredSlides:!1,loopFillGroupWithBlank:!0,breakpoints:{320:{slidesPerView:1,slidesPerGroup:1,spaceBetween:10},769:{slidesPerView:3,slidesPerGroup:1,spaceBetween:10}},autoplay:{delay:3500,disableOnInteraction:!1,pauseOnMouseEnter:!0},lazy:!0,pagination:{el:".swiper-pagination",dynamicBullets:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}else if(GameHallUtils.isNEW()){new Swiper(".section-BONUSEVENT .swiper",{effect:"cube",grabCursor:!0,centeredSlides:!0,slidesPerView:"auto",autoplay:{delay:3e3,disableOnInteraction:!1,pauseOnMouseEnter:!0},lazy:!0,pagination:{el:".swiper-pagination",clickable:!0},cubeEffect:{shadow:!0}})}else if(!gameHallRwd.includes(e)){new Swiper(".section-BONUSEVENT .swiper",{lazy:!0,autoplay:!!s&&{delay:5e3,disableOnInteraction:!1,pauseOnMouseEnter:!0},breakpoints:{320:{slidesPerView:1.1,spaceBetween:8,centeredSlides:!0,slidesPerGroup:1},769:{slidesPerView:s?n:a,slidesPerGroup:1,spaceBetween:10}},pagination:{el:".swiper-pagination",dynamicBullets:!0}})}console.timeEnd("swiper")};let c={};BonusEventHandler.putAudio=(e,t)=>{let n=c[e]||"";"HTMLAudioElement"!=n.constructor.name&&(n=new Audio(t),c[e]=n),n.src&&n.src.endsWith(t)||(n.src=t)},BonusEventHandler.getAudio=e=>{let t=c[e]||"";if("HTMLAudioElement"!=t.constructor.name)throw"no audio:"+e;if(!t.src)throw"no src:"+e;return t},BonusEventHandler.playAudio=e=>new Promise(t=>{let n=BonusEventHandler.getAudio(e);n.onended=t,n.play().catch(e=>{console.log(e)})}),BonusEventHandler.animateNum=function(e,t,n){let a=$j(e).text();if(!a)return void $j(e).text(t);if(a=a.replace(/\$|\,/g,""),(t=t.replace(/\$|\,/g,""))-a<=0)return void $j(e).text(NumberFormatUtil.formatNumber(t,2));let s=Math.pow(10,2);$j(e).prop("number",a*s).animateNumber({number:t*s,numberStep:function(e,t){let n=Math.floor(e)/s,a=$j(t.elem);n=n.toFixed(2),a.prop("number",e).text(NumberFormatUtil.formatNumber(n,2))},easing:"easeInQuad"},n)},BonusEventHandler.createRewardSlots=function(e,t,n){const a=$j('<img class="slot-bg-blue" src="'+PageConfig.imagePrefix+'/theme/images/src-common/BONUSEVENT-img/CHANCEGAME/bonus-green-bg.webp" alt="">');for(let s=0;s<12;s++){let i=document.createElement("div");i.className="slot";let o="rotateX("+30*s+"deg) translateZ(90px)";i.style.transform=o;let l=0==s?t[0]:t[s%t.length];$j(i).append("<p>"+l+"</p>"),n||$j(i).append(a.clone()),e.append(i)}},BonusEventHandler.refreshRewardSlots=function(e){e.innerHTML="",e.className="ring",e.style=""},BonusEventHandler.clickRankReward=function(e,t){let n=$j(e).attr("bonusId"),a=$j(`#PageDiv${n}`),s=a[0].safeSelector("#rankReward").safeSelector("#"+t+"Reward"),i=$j(e).attr("rankRewardSetting"),o=a[0].safeSelector("#rankRewardEffect"),l=a[0].safeSelector("#miniSlotTemplateStage"),r=a[0].safeSelector("#rankRewardSlot");if(!BonusEventHandler.takeTicketLock){if(a[0].safeSelector("#rankReward").querySelectorAll(".tournament-badge-box a").forEach(e=>{e.classList.contains(t)||e.classList.remove("active")}),l.classList.remove("select-tour"),o.classList.remove("show"),a[0].safeSelector("#stage").classList.remove("select"),a[0].classList.remove("daily"),a[0].classList.remove("weekly"),a[0].classList.remove("monthly"),r.className="slot-box",r.offsetWidth,s.classList.contains("active"))s.classList.remove("active");else if(parseInt(a[0].safeSelector("#rankReward").safeSelector("#"+t+"RewardCnt").innerText)>0){s.classList.add("active"),r.classList.add(t),a[0].classList.add(t);let e=i.split(","),n=new Array;for(let t=0;t<e.length;t++)e[t]="+"+e[t]+"%",e.indexOf(e[t])===t&&n.push(e[t]);BonusEventHandler.refreshRewardSlots(r.safeSelector("#ring1")),BonusEventHandler.createRewardSlots(r.safeSelector("#ring1"),e,!1),r.safeSelector(".bonus-info").innerHTML="<span>"+n.join(",")+"</span>",l.classList.add("select-tour"),o.classList.add("show"),a[0].safeSelector("#stage").classList.add("select")}if("GOLDEN_EGG"==a[0].getAttribute("presentType"))if("none"==r.style.display){let e=a[0].getAttribute("skinName"),t=document.getElementById(`${e}WinArea`);BonusEventHandler.refreshRewardSlots(t.safeSelector("#ring1"));let n=i.split(",");for(let e=0;e<n.length;e++)n[e]="+"+n[e]+"%";BonusEventHandler.createRewardSlots(t.safeSelector("#ring1"),n,!0),r.style.display="block"}else r.style.display="none"}},BonusEventHandler.spinRewardSlots=function(e,t,n){let a=t.rankRewardPercentage,s=t.rankRewardRateMultiplier;e.find("#dailyRewardCnt").text(t.rankRecordDailyMedal),e.find("#weeklyRewardCnt").text(t.rankRecordWeeklyMedal),e.find("#monthlyRewardCnt").text(t.rankRecordMonthlyMedal);let i=e[0].querySelector("#rankRewardAnime"),o=BonusEventPresentHandler.getHandler(e.attr("presentType"));return new Promise(n=>{AudioPlayer.playMusicOnLoad(o.dataRewardswift,o.dataRewardSpin),i?"ROULETTE"==t.presentType?(i.classList.add("start"),setTimeout(()=>{e.find("#tournamentObject").addClass("active"),e.find("#tournamentMove").css("display","block"),"ROULETTE"==t.presentType&&(i.style.display="none")},500),setTimeout(()=>{e.find("#rankRewardSlot").addClass("active"),n()},700)):"MARIOSLOT"==t.presentType?(i.classList.add("start"),setTimeout(()=>{e.find("#tournamentObject").addClass("active"),e.find("#tournamentMove").css("display","block"),"ROULETTE"==t.presentType&&(i.style.display="none"),e.find("#rankRewardSlot").addClass("active"),n()},2500)):n():"TREASURE_PICK"==t.presentType?(e.find("#box"+t.remark).effect("transfer",{to:e[0].safeSelector("#rankReward").safeSelector("#stage")},1e3),e[0].safeSelector("#rankReward").safeSelector("#stage").classList.add("tt-light"),setTimeout(()=>{n()},1e3)):n()}).then(()=>{let l=0;return"ROULETTE"==t.presentType||"TREASURE_PICK"==t.presentType?l=2800:"MARIOSLOT"==t.presentType&&(l=1800),new Promise(r=>{let d=s.indexOf(a+"");if(e.find("#rankRewardSlot").addClass("active"),"MARIOSLOT"==t.presentType){AudioPlayer.playMusicOnLoad(o.dataRewardspin,o.dataClear),number=(d+8)%12;let t=e[0].safeSelector("#rankRewardSlot").safeSelector("#ring1");t.style.animation="back-spin 0s, spin-"+number+" 0s",t.className="ring spin-"+number,setTimeout(()=>{e[0].safeSelector("#rankReward").safeSelector("#stage").classList.add("active"),t.querySelectorAll("div")[d].classList.add("active")},500),e[0].safeSelector("#rankReward").safeSelector("#stage").classList.add("active")}else AudioPlayer.playMusicOnLoad(o.dataRewardspin,o.dataClear),setTimeout(()=>{e[0].safeSelector("#rankReward").safeSelector("#stage").classList.add("active"),number=(d+8)%12;let t=e[0].safeSelector("#rankRewardSlot").safeSelector("#ring1");t.style.animation="back-spin 1s, spin-"+number+" 1.8s",t.className="ring spin-"+number},500);setTimeout(()=>{e[0].safeSelector("#rankReward").safeSelector("#stage").classList.remove("active");let a=e[0].safeSelector("#rankRewardSlot").safeSelector("#ring1");a.style.animation="",a.className="ring","function"==typeof n&&n(),0!=t.rankRecordDailyMedal?e.find("#dailyCheckIn").removeClass("no-ticket"):(e.find("#dailyCheckIn").addClass("no-ticket"),e.find("#rankRewardSlot").removeClass("daily")),0!=t.rankRecordWeeklyMedal?e.find("#weeklyReward").removeClass("no-ticket"):(e.find("#weeklyReward").addClass("no-ticket"),e.find("#rankRewardSlot").removeClass("weekly")),0!=t.rankRecordMonthlyMedal?e.find("#monthlyReward").removeClass("no-ticket"):(e.find("#monthlyReward").addClass("no-ticket"),e.find("#rankRewardSlot").removeClass("monthly")),i&&(i.classList.remove("start"),i.style.display=""),e[0].safeSelector("#miniSlotTemplateStage").classList.remove("select-tour"),e[0].safeSelector("#rankRewardEffect").classList.remove("show"),e[0].safeSelector("#stage").classList.remove("active"),e[0].safeSelector("#rankRewardSlot").className="slot-box",e[0].safeSelector("#stage").classList.remove("select"),e.find("#rewardType a").removeClass("active"),e.find("#tournamentObject").removeClass("active"),e.find("#tournamentMove").css("display",""),r()},l)})})},BonusEventHandler.spinEggRewardSlots=function(e,t,n){let a=n.rankRewardPercentage,s=n.rankRewardRateMultiplier;e.find("#dailyRewardCnt").text(n.rankRecordDailyMedal),e.find("#weeklyRewardCnt").text(n.rankRecordWeeklyMedal),e.find("#monthlyRewardCnt").text(n.rankRecordMonthlyMedal),t.safeSelector("#goldenEggWinBonus").style.display="block",t.safeSelector("#winAreaRankRewardSlot").style.display="block";BonusEventPresentHandler.getHandler(e.attr("presentType"));t.safeSelector("#goldenEggWinBonus").innerHTML=n.award;return new Promise(i=>{let o=s.indexOf(a+"");t.safeSelector("#winAreaRankRewardSlot").classList.add("active"),setTimeout(()=>{t.safeSelector("#stage").classList.add("active");let e=(o+8)%12,n=t.safeSelector("#winAreaRankRewardSlot").safeSelector("#ring1");n.style.animation="back-spin 1s, spin-"+e+" 1.8s",n.className="ring spin-"+e},500),setTimeout(()=>{0!=n.rankRecordDailyMedal?e.find("#dailyCheckIn").removeClass("no-ticket"):(e.find("#dailyCheckIn").addClass("no-ticket"),e.find("#rankRewardSlot").removeClass("daily")),0!=n.rankRecordWeeklyMedal?e.find("#weeklyReward").removeClass("no-ticket"):(e.find("#weeklyReward").addClass("no-ticket"),e.find("#rankRewardSlot").removeClass("weekly")),0!=n.rankRecordMonthlyMedal?e.find("#monthlyReward").removeClass("no-ticket"):(e.find("#monthlyReward").addClass("no-ticket"),e.find("#rankRewardSlot").removeClass("monthly")),e.find("#dailyCheckIn").removeClass("active"),e.find("#weeklyReward").removeClass("active"),e.find("#monthlyReward").removeClass("active"),0==n.rankRecordDailyMedal&&0==n.rankRecordWeeklyMedal&&0==n.rankRecordMonthlyMedal&&(e.find("#stage").removeClass("select"),e.find("#bonusGroup").hide()),e.find("#rankRewardSlot").hide().attr("class","slot-box"),i()},2800)})},BonusEventHandler.closeMiniGameResult=function(e){let t=$j(e).data("bonusid"),n=$j(`#PageDiv${t}`);BonusEventPresentHandler.getHandler(n.attr("presentType")).onCloseFancyAlert(n);let a=$j("#chanceGameAlert");a.attr("class","function-alert ChanceGame win-chance"),a.find(".slot-s").show(),a.find(".bonus-win-gold").hide()},BonusEventHandler.openBank=function(e){$j("#bankingDeposit").length>0?$j("#bankingDeposit").click():$j("#player_banking_deposit").length>0?$j("#player_banking_deposit").click():$j("#depositfooterLink").length>0&&$j("#depositfooterLink").click()},BonusEventHandler.buildGameTag=function(){},BonusEventHandler.bindDailyMissionUnloadEvent=function(e){console.log("登入前不需執行")}}();